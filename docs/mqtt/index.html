---
type: page
title: OTA Messages
---

<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <title>OTA Messages</title>
        <link rel="canonical" href="https://ruterwiki.ruter.no/pages/viewpage.action?pageId=$action.page.id">
        <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\u0022\u0022";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script>
<link type="text/css" rel="stylesheet" href="files/batch_003.css" data-wrm-key="_super" data-wrm-batch-type="context" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/e59842b492d601ab1c95ca61f0ed1c84-CDN/en_GB/7202/2b917bf474320363b63231a29396d24a46356543/6b1a0bd9616beed894f84140ca66cfa6/_/download/contextbatch/css/_super/batch.css?conditionalComment=lt+IE+9" data-wrm-key="_super" data-wrm-batch-type="context" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/e59842b492d601ab1c95ca61f0ed1c84-CDN/en_GB/7202/2b917bf474320363b63231a29396d24a46356543/6b1a0bd9616beed894f84140ca66cfa6/_/download/contextbatch/css/_super/batch.css?conditionalComment=lte+IE+9" data-wrm-key="_super" data-wrm-batch-type="context" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="files/batch_002.css" data-wrm-key="plugin.viewsource,-_super" data-wrm-batch-type="context" media="all">
<link type="text/css" rel="stylesheet" href="files/batch.css" data-wrm-key="page,-_super" data-wrm-batch-type="context" media="all">
<link type="text/css" rel="stylesheet" href="files/batch_005.css" media="print" data-wrm-key="page,-_super" data-wrm-batch-type="context">
<link type="text/css" rel="stylesheet" href="files/batch_004.css" data-wrm-key="editor-content,-_super" data-wrm-batch-type="context" media="all">
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/78252be7cff6fc6cea5c334d15c95ba6-CDN/en_GB/7202/2b917bf474320363b63231a29396d24a46356543/f4793cb0b38efc2a0c92dc4f2a621402/_/download/contextbatch/css/editor-content,-_super/batch.css?conditionalComment=lte+IE+9&amp;confluence.table.resizable=true&amp;confluence.view.edit.transition=true" data-wrm-key="editor-content,-_super" data-wrm-batch-type="context" media="all">
<![endif]-->
<!--[if IE]>
<link type="text/css" rel="stylesheet" href="/s/78252be7cff6fc6cea5c334d15c95ba6-CDN/en_GB/7202/2b917bf474320363b63231a29396d24a46356543/f4793cb0b38efc2a0c92dc4f2a621402/_/download/contextbatch/css/editor-content,-_super/batch.css?confluence.table.resizable=true&amp;confluence.view.edit.transition=true&amp;ieonly=true" data-wrm-key="editor-content,-_super" data-wrm-batch-type="context" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="files/colors.css" media="all">
<link type="text/css" rel="stylesheet" href="files/default-theme.css" media="all">
<link type="text/css" rel="stylesheet" href="files/theme-colors.css" media="all">

    </head>

    <body class="mceContentBody aui-theme-default wiki-content fullsize">
	<h1 id="title-text" class="with-breadcrumbs" style="display: block;">OTA Messages</h1>
        <p>&nbsp;</p>         
        <p class="auto-cursor-target"><br></p><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="e3bd86c4-c7b8-47e0-add8-403ac06b5131" data-macro-schema-version="1" style="background-image: url(/plugins/servlet/confluence/placeholder/macro-heading?definition=e2luZm99&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tbody><tr><td class="wysiwyg-macro-body">The English version of this document is now the official and maintained version. The Norwegian version is no longer valid.</td></tr></tbody></table>
        <h1>Introduction</h1>
        <p>This page is an update of an outdated OTA Messages wiki page that was based 
on version 1.0 of the requirements. Version 1.1 of the requirements 
introduced some changes and after the development process began, new 
needs were identified as documented here, partly for use in formulating a
 change order for the operators selected for routes in Romerike and the 
electric bus contract.</p><p>Ruter has agreed with the operators to use 
only JSON in MQTT messages and not support Protobuf.&nbsp;The contents 
of the messages will therefore be defined by JSON schemas and these will
 be made available to the operators.</p><h1>Summary</h1><p>The summary refers to topics on board the buses. See below for mapping of the local topic to the bridged topic.</p><p>Changes noted in status are based on a comparison with v. 1.1 of the OTA Messages document. Direction is in/out of the bus.</p><table class="fixed-table confluenceTable"><colgroup><col style="width: 230.0px;"><col style="width: 93.0px;"><col style="width: 82.0px;"><col style="width: 177.0px;"><col style="width: 372.0px;"></colgroup><thead><tr><th class="confluenceTh"><p>Local topic</p></th><th class="confluenceTh"><p>Change</p></th><th colspan="1" class="confluenceTh"><p>Direction</p></th><th colspan="1" class="confluenceTh"><p>Name</p></th><th colspan="1" class="confluenceTh"><p>Comments</p></th></tr></thead><tbody><tr><td class="confluenceTd">signon/json</td><td class="confluenceTd"><br></td><td class="confluenceTd">Out</td><td class="confluenceTd"><span style="color: rgb(0,0,0);">Start block&nbsp;</span></td><td class="confluenceTd"><br></td></tr><tr><td class="confluenceTd">signoff/json</td><td class="confluenceTd"><br></td><td class="confluenceTd"><span>Out</span></td><td class="confluenceTd"><span style="color: rgb(0,0,0);">Complete block&nbsp;</span></td><td class="confluenceTd"><br></td></tr><tr><td class="confluenceTd">avl/json</td><td class="confluenceTd"><br></td><td class="confluenceTd"><span>Out</span></td><td class="confluenceTd"><span style="color: rgb(0,0,0);">Vehicle position&nbsp;</span></td><td class="confluenceTd"><br></td></tr><tr><td class="confluenceTd">apc/+/json</td><td class="confluenceTd"><br></td><td colspan="1" class="confluenceTd"><span>Out</span></td><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Passenger count&nbsp;</span></td><td colspan="1" class="confluenceTd">"+" is the placeholder for the door number</td></tr><tr><td colspan="1" class="confluenceTd">stopsignal/json</td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">New</td><td colspan="1" class="confluenceTd"><span>Out</span></td><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);"><span>Stop signal status</span></span></td><td colspan="1" class="confluenceTd">This signal does not exist in FMS and must be read directly from the electrical signal system on board</td></tr><tr><td colspan="1" class="confluenceTd">telemetry/+/json</td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green"><span>New</span></td><td colspan="1" class="confluenceTd"><span>Out</span></td><td colspan="1" class="confluenceTd">Vehicle telemetry</td><td colspan="1" class="confluenceTd">"+"
 is the placeholder for an ID, such as PGN which is defined in the FMS 
standard; We specify which PGN or other telemetry data should be sent.<br><strong>Used to be fmstoip but has now been generalized.&nbsp;</strong></td></tr><tr><td class="confluenceTd">infohub/dpi/diagnostics/json</td><td class="highlight-green confluenceTd" data-highlight-colour="green"><span>New</span></td><td class="confluenceTd"><span>Out</span></td><td class="confluenceTd">Diagnostics for screens</td><td class="confluenceTd">DPI diagnostics data to make sure the displays are set up correctly and are running as expected</td></tr><tr><td class="confluenceTd">tsp/json</td><td class="highlight-green confluenceTd" data-highlight-colour="green"><span>New</span></td><td class="confluenceTd">In</td><td class="confluenceTd">Signal prioritization</td><td class="confluenceTd">Message to be sent directly from the bus to facilitate signal priority at traffic lights</td></tr><tr><td colspan="1" class="confluenceTd">madt/notification/json</td><td colspan="1" class="confluenceTd"><br></td><td colspan="1" class="confluenceTd">In</td><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Message to driver</span></td><td colspan="1" class="confluenceTd">Unclear who is producing and consuming this message</td></tr><tr><td colspan="1" class="confluenceTd">infohub/dpi/journey/json</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">Modified</td><td colspan="1" class="confluenceTd">In</td><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Vehicle journey</span></td><td colspan="1" class="confluenceTd">Coordinates for the stop are now included; stopPointRef was changed to stopPlaceId in v. 1.1</td></tr><tr><td colspan="1" class="confluenceTd">infohub/dpi/nextstop/json</td><td colspan="1" class="confluenceTd"><br></td><td colspan="1" class="confluenceTd">In</td><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Next stop&nbsp;</span></td><td colspan="1" class="confluenceTd"><span>stopPointRef was changed to stopPlaceId in v. 1.1</span></td></tr><tr><td colspan="1" class="confluenceTd">infohub/dpi/eta/json</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow"><span>Modified</span></td><td colspan="1" class="confluenceTd">In</td><td colspan="1" class="confluenceTd">Estimated arrivals</td><td colspan="1" class="confluenceTd">The text for the time to be displayed on the screen is now included;&nbsp;<span>stopPointRef was changed to stopPlaceId in v. 1.1</span></td></tr><tr><td colspan="1" class="confluenceTd">infohub/dpi/externaldisplay/json</td><td colspan="1" class="confluenceTd"><br></td><td colspan="1" class="confluenceTd">In</td><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Information on sign box</span></td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd">infohub/dpi/arriving/json</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow"><span>Modified</span></td><td colspan="1" class="confluenceTd">In</td><td colspan="1" class="confluenceTd">Arriving</td><td colspan="1" class="confluenceTd">Public announcement of the stop; adds expiryTimestamp and zoneId field; createTimestamp was deleted in v. 1.1</td></tr><tr><td colspan="1" class="confluenceTd">infohub/dpi/deviation/json</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow"><span>Modified</span></td><td colspan="1" class="confluenceTd">In</td><td colspan="1" class="confluenceTd">Deviation</td><td colspan="1" class="confluenceTd">Multi-lingual, textual deviation messages. With references to stops/journal/lines etc.</td></tr><tr><td colspan="1" class="confluenceTd">infohub/dpi/announcement/json</td><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow"><span>Modified</span></td><td colspan="1" class="confluenceTd">In</td><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Other announcement&nbsp;</span></td><td colspan="1" class="confluenceTd">Multi-lingual textual messages</td></tr><tr><td colspan="1" class="confluenceTd">infohub/dpi/audio/json</td><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">New</td><td colspan="1" class="confluenceTd">In</td><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Audio message</span></td><td colspan="1" class="confluenceTd">Audio messages to be played on the bus. Can contain an array of messages with different target speakers and codecs.</td></tr><tr><td class="confluenceTd">infohub/dpi/c2/json</td><td class="highlight-green confluenceTd" data-highlight-colour="green"><span>New</span></td><td class="confluenceTd"><span>In</span></td><td class="confluenceTd">DPI command and control messages</td><td class="confluenceTd">Command and control messages to be used by DPI, from Ruter backend.</td></tr><tr><td colspan="1" class="confluenceTd">infohub/dpi/connections/json</td><td class="highlight-grey confluenceTd" colspan="1" data-highlight-colour="grey">Planned</td><td colspan="1" class="confluenceTd">In</td><td colspan="1" class="confluenceTd">Information about connections</td><td colspan="1" class="confluenceTd">Real-time data for connections before arrival at the stop</td></tr><tr><td colspan="1" class="confluenceTd">infohub/dpi/digitalsignage/json</td><td class="highlight-grey confluenceTd" colspan="1" data-highlight-colour="grey">Planned</td><td colspan="1" class="confluenceTd">In</td><td colspan="1" class="confluenceTd">Multimedia control</td><td colspan="1" class="confluenceTd">Message that controls the multimedia surfaces on board</td></tr></tbody></table><h1>Topics</h1><h2>signon/json&nbsp;</h2><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Start block&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Description</th><td colspan="1" class="confluenceTd"><p><span style="color: rgb(0,0,0);">Notify PTA BO that the bus is starting a block</span></p></td></tr><tr><th colspan="1" class="confluenceTh">Local topic</th><td colspan="1" class="confluenceTd">signon/json</td></tr><tr><th colspan="1" class="confluenceTh">Bridged topic</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">ruter/&lt;sender&gt;/&lt;vehicleid&gt;/itxpt/ota/signon/json&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Schema</th><td colspan="1" class="confluenceTd">signon.json</td></tr></tbody></table><h3>JSON example</h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="ede58e08-0003-4c6a-b7e6-59485f64fb40" data-macro-parameters="language=js" data-macro-schema-version="1" style="background-image: url(/plugins/servlet/confluence/placeholder/macro-heading?definition=e2NvZGU6bGFuZ3VhZ2U9anN9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tbody><tr><td class="wysiwyg-macro-body"><pre>{
  "eventTimestamp": "2017-10-31T12:45:50Z",
  "vehicleNumber": "12345",
  "blockId": "1234:34",
  "vehicleJourneyId": "35:ABC"
}</pre></td></tr></tbody></table><h3>Fields</h3><table class="confluenceTable"><colgroup><col><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">eventTimestamp</td><td class="confluenceTd">string</td><td class="confluenceTd">ISO 8601,&nbsp;UTC</td></tr><tr><td colspan="1" class="confluenceTd">vehicleNumber</td><td colspan="1" class="confluenceTd">integer</td><td colspan="1" class="confluenceTd">same as for the bridged topic</td></tr><tr><td colspan="1" class="confluenceTd">blockId</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">A series of journeys</td></tr><tr><td colspan="1" class="confluenceTd">vehicleJourneyId</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">The actual journey started</td></tr></tbody></table><p>Vehicle journey is required and helps track cases where blocks are interrupted and replacement vehicles take over.</p><h2>signoff/json</h2><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Complete block&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Description</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Notify PTA BO that the bus has completed a block</span></td></tr><tr><th colspan="1" class="confluenceTh">Local topic</th><td colspan="1" class="confluenceTd">signoff/json</td></tr><tr><th colspan="1" class="confluenceTh">Bridged topic</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">ruter/&lt;sender&gt;/&lt;vehicleid&gt;/itxpt/ota/signoff/json&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Schema</th><td colspan="1" class="confluenceTd">signon.json</td></tr></tbody></table><p>The content of signoff is the same as signon and uses the same schema.</p><h2>avl/json</h2><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><td colspan="1" class="confluenceTd">Vehcile position</td></tr><tr><th colspan="1" class="confluenceTh">Description</th><td colspan="1" class="confluenceTd">Reporting of the bus's position, course and speed to PTA BO</td></tr><tr><th colspan="1" class="confluenceTh">Local topic</th><td colspan="1" class="confluenceTd">avl/json</td></tr><tr><th colspan="1" class="confluenceTh">Bridged topic</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">ruter/&lt;sender&gt;/&lt;vehicleid&gt;/itxpt/ota/avl/json&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Schema</th><td colspan="1" class="confluenceTd">avl.json</td></tr></tbody></table><h3>JSON example</h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="b30d421f-5300-439a-9ef4-5edb758e312a" data-macro-parameters="language=js" data-macro-schema-version="1" style="background-image: url(/plugins/servlet/confluence/placeholder/macro-heading?definition=e2NvZGU6bGFuZ3VhZ2U9anN9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tbody><tr><td class="wysiwyg-macro-body"><pre>{
  "eventTimestamp": "2017-10-31T12:45:50Z",
  "seqNumber": 0,
  "latitude": 60.25255,
  "longitude": 11.0567,
  "heading": 0.5,
  "speedOverGround": 34.5,
  "signalQuality": "AGPS_QUALITY",
  "numberOfSatellites": 4,
  "gnssType": "GPS",
  "gnssCoordinateSystem": "WGS84",
  "deadReckoning": false,
  "positionIsSimulated": false
}</pre></td></tr></tbody></table><h3><span style="color: rgb(0,0,0);font-size: 16.0px;font-weight: bold;">Fields</span></h3><table class="confluenceTable"><colgroup><col><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">eventTimestamp</td><td class="confluenceTd">string</td><td class="confluenceTd">ISO 8601,&nbsp;UTC</td></tr><tr><td colspan="1" class="confluenceTd">seqNumber</td><td colspan="1" class="confluenceTd">integer</td><td colspan="1" class="confluenceTd">used to ensure that the messages are processed in the correct order</td></tr><tr><td colspan="1" class="confluenceTd">latitude</td><td colspan="1" class="confluenceTd">float</td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd">longitude</td><td colspan="1" class="confluenceTd">float</td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd">heading</td><td colspan="1" class="confluenceTd">float</td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd">speedOverGround</td><td colspan="1" class="confluenceTd">float</td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd">signalQuality</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">enum&nbsp;<span style="color: rgb(0,0,0);">SignalQuality&nbsp;</span></td></tr><tr><td colspan="1" class="confluenceTd">numberOfSatellites</td><td colspan="1" class="confluenceTd">integer</td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd">gnssType</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">enum&nbsp;<span style="color: rgb(0,0,0);">GNSSType&nbsp;</span></td></tr><tr><td colspan="1" class="confluenceTd">gnssCoordinateSystem</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">enum&nbsp;<span style="color: rgb(0,0,0);">GNSSCoordinateSystem&nbsp;</span></td></tr><tr><td colspan="1" class="confluenceTd">deadReckoning</td><td colspan="1" class="confluenceTd">boolean</td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd">positionIsSimulated</td><td colspan="1" class="confluenceTd">boolean</td><td colspan="1" class="confluenceTd">true when a block is simulated</td></tr></tbody></table><h3>Enum SignalQuality</h3><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><span style="color: rgb(0,0,0);">AGPS_QUALITY</span></td><td class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">DGPS_QUALITY</span></td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">ESTIMATED_QUALITY</span></td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">GPS_QUALITY</span></td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">NOT_VALID_QUALITY</span></td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">UNKNOWN_QUALITY</span></td><td colspan="1" class="confluenceTd"><br></td></tr></tbody></table><h3>Enum GNSSType</h3><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><span style="color: rgb(0,0,0);">GPS</span></td><td class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">GLONASS</span></td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">GALILEO</span></td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">BEIDOU</span></td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">IRNSS</span></td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">OTHER</span></td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">DEAD_RECKONING</span></td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">MIXED_GNSS_TYPES</span></td><td colspan="1" class="confluenceTd"><br></td></tr></tbody></table><h3>Enum&nbsp;<span style="color: rgb(0,0,0);">GNSSCoordinateSystem</span></h3><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><span style="color: rgb(0,0,0);">WGS84 </span></td><td class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">AGPS</span></td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">DGPS</span></td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">ESTIMATED</span></td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">GPS_COORDINATE_SYSTEM</span></td><td colspan="1" class="confluenceTd"><br></td></tr></tbody></table><h2><span style="color: rgb(0,0,0);font-size: 20.0px;">apc/+/json</span></h2><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Passenger count</span></td></tr><tr><th colspan="1" class="confluenceTh">Description</th><td colspan="1" class="confluenceTd"><p>Report of passenger count per door to PTA BO</p></td></tr><tr><th colspan="1" class="confluenceTh">Local topic</th><td colspan="1" class="confluenceTd">apc/<span style="color: rgb(0,0,0);">&lt;doorid&gt;</span>/json</td></tr><tr><th colspan="1" class="confluenceTh">Bridged topic</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">ruter/&lt;sender&gt;/&lt;vehicleid&gt;/itxpt/ota/apc/&lt;doorid&gt;/json</span></td></tr><tr><th colspan="1" class="confluenceTh">Schema</th><td colspan="1" class="confluenceTd">apc.json</td></tr></tbody></table><h3>JSON example</h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="e8d92a78-158e-48bb-8b3f-5a02bcc528fa" data-macro-parameters="language=js" data-macro-schema-version="1" style="background-image: url(/plugins/servlet/confluence/placeholder/macro-heading?definition=e2NvZGU6bGFuZ3VhZ2U9anN9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tbody><tr><td class="wysiwyg-macro-body"><pre>{
  "eventTimestamp": "2017-10-31T12:45:50Z",
  "doorId": 1,
  "passengerCounting": [{
    "objectClass": "ADULT",
    "doorPassengerIn": 1,
    "doorPassengerOut": 1
  }, {
    "objectClass": "CHILD",
    "doorPassengerIn": 0,
    "doorPassengerOut": 0
  }, {
    "objectClass": "PRAM",
    "doorPassengerIn": 0,
    "doorPassengerOut": 0
  }, {
    "objectClass": "WHEELCHAIR",
    "doorPassengerIn": 0,
    "doorPassengerOut": 0
  }],
  "doorCountQuality": "REGULAR"
}</pre></td></tr></tbody></table><h3><span style="color: rgb(0,0,0);font-size: 16.0px;font-weight: bold;">Fields</span></h3><h4>APC</h4><table class="confluenceTable"><colgroup><col><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">eventTimestamp</td><td class="confluenceTd">string</td><td class="confluenceTd">ISO 8601,&nbsp;UTC</td></tr><tr><td colspan="1" class="confluenceTd">doorId</td><td colspan="1" class="confluenceTd">integer</td><td colspan="1" class="confluenceTd">Data is reported only per door</td></tr><tr><td colspan="1" class="confluenceTd">passengerCounting</td><td colspan="1" class="confluenceTd">array of PassengerCount</td><td colspan="1" class="confluenceTd">One PassengerCount per ObjectClass</td></tr><tr><td colspan="1" class="confluenceTd">doorCountQuality</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">enum CountQuality</td></tr></tbody></table><h4>PassengerCount</h4><table class="confluenceTable"><colgroup><col><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">objectClass</td><td class="confluenceTd">string</td><td class="confluenceTd">enum&nbsp;<span style="color: rgb(0,0,0);">ObjectClass&nbsp;</span></td></tr><tr><td colspan="1" class="confluenceTd">doorPassengerIn</td><td colspan="1" class="confluenceTd">integer</td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd">doorPassengerOut</td><td colspan="1" class="confluenceTd">integer</td><td colspan="1" class="confluenceTd"><br></td></tr></tbody></table><h4>Enum ObjectClass</h4><table class="confluenceTable"><colgroup><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd"><span style="color: rgb(0,0,0);">ABSENT&nbsp;</span></td><td class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">ADULT&nbsp;</span></td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">CHILD&nbsp;</span></td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">PRAM</span></td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">BIKE</span></td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">WHEELCHAIR</span></td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">OTHER</span></td><td colspan="1" class="confluenceTd"><br></td></tr></tbody></table><h4>Enum CountQuality</h4><table class="confluenceTable"><colgroup><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">ABSENT</td><td class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">REGULAR&nbsp;</span></td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">DEFECT&nbsp;</span></td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">OTHER&nbsp;</span></td><td colspan="1" class="confluenceTd"><br></td></tr></tbody></table><h2>stopsignal/json</h2><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);">Stop signal status</span></span></td></tr><tr><th colspan="1" class="confluenceTh">Description</th><td colspan="1" class="confluenceTd"><p>Stop signal status when changed by using stop button</p></td></tr><tr><th colspan="1" class="confluenceTh">Local topic</th><td colspan="1" class="confluenceTd">stopsignal/json</td></tr><tr><th colspan="1" class="confluenceTh">Bridged topic</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">ruter/&lt;sender&gt;/&lt;vehicleid&gt;/itxpt/ota/stopsignal/json</span></td></tr><tr><th colspan="1" class="confluenceTh">Schema</th><td colspan="1" class="confluenceTd">stopsignal.json</td></tr></tbody></table><h3>JSON example</h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="0f6510e9-1054-4943-a309-4d27dc106b87" data-macro-parameters="language=js" data-macro-schema-version="1" style="background-image: url(/plugins/servlet/confluence/placeholder/macro-heading?definition=e2NvZGU6bGFuZ3VhZ2U9anN9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tbody><tr><td class="wysiwyg-macro-body"><pre>{
  "eventTimestamp": "2017-10-31T12:45:50Z",
  "stopSignalled": true
}</pre></td></tr></tbody></table><h3>Fields</h3><table class="confluenceTable"><colgroup><col><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">eventTimestamp</td><td class="confluenceTd">string</td><td class="confluenceTd">ISO 8601,&nbsp;UTC</td></tr><tr><td colspan="1" class="confluenceTd">stopSignalled</td><td colspan="1" class="confluenceTd">boolean</td><td colspan="1" class="confluenceTd"><br></td></tr></tbody></table><h2>telemetry/+/json</h2><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Vehicle telemetry</span></td></tr><tr><th colspan="1" class="confluenceTh">Description</th><td colspan="1" class="confluenceTd"><p>Vehicle <span style="color: rgb(0,0,0);">telemetry</span> from systems on the bus</p></td></tr><tr><th colspan="1" class="confluenceTh">Local topic</th><td colspan="1" class="confluenceTd">telemetry/&lt;id&gt;/json</td></tr><tr><th colspan="1" class="confluenceTh">Bridged topic</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">ruter/&lt;sender&gt;/&lt;vehicleid&gt;/itxpt/ota/telemetry/&lt;id&gt;/json</span></td></tr><tr><th colspan="1" class="confluenceTh">Schema</th><td colspan="1" class="confluenceTd">telemetry.json</td></tr></tbody></table><p>Several
 different kinds of telemetry are available varying by vehicle type. For
 traditional busses, FMS is the standard defines what data about the 
vehicle is published on the FMS bus and out by FMStoIP. For trams 
VehicleToIP defines a a different and more limited set of data. In 
addition, electrical and hydrogen have proprietary data that is not 
captured by either.</p><p>This topic generalizes all such data as 
telemetry defined by a unique id. We will use FMS PGN ids (4-digit hex 
values, i.e. ) but otherwise use unique ids to identify data from other 
sources.</p><p>If we define the ids along the lines of FMS we can have 32-bit ids that use the following pattern:</p><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Bytes</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd">1</td><td class="confluenceTd">Source identifier</td></tr><tr><td class="confluenceTd">2-4</td><td class="confluenceTd">Source-specific id, e.g. FMS PGNs</td></tr></tbody></table><p>Source identifiers will be:</p><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Id</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd">0x00</td><td class="confluenceTd">FMS</td></tr><tr><td class="confluenceTd">0x01</td><td class="confluenceTd">non-FMS</td></tr><tr><td colspan="1" class="confluenceTd">...</td><td colspan="1" class="confluenceTd">new sources</td></tr></tbody></table><p>Therefore all FMS PGNs become "0000" + 4-digit hex PGN.</p><h3>FMS</h3><p>Each
 of the available data points is defined with a Parameter Group Number 
(PGN) with fields defined by Suspect Parameter Number (SPN).</p><p>The 
FMS-to-IP service in the ITxPT standard makes the desired data available
 on the bus's own network over UDP (multicast broadcast). It sends out 
only the PGNs previously requested by calling a service. The messages 
are sent every second, according to ITxPT, and includes all the 
requested PGNs. The format is in XML.</p><p>We therefore define which PGNs are needed by Ruter and that the XML message should be broken up per PGN and forwarded as JSON.</p><h3>FMS&nbsp;Parameter Group Number (PGN)</h3><p>This is the list of required PGNs. It should be possible to expand this over time.</p><table class="confluenceTable"><colgroup><col><col><col><col><col><col><col></colgroup><thead><tr><th colspan="1" class="confluenceTh"><p>Kode</p></th><th colspan="1" class="confluenceTh"><p>Description</p></th><th class="confluenceTh"><p>PGN</p></th><th class="confluenceTh"><p>SPN</p></th><th colspan="1" class="confluenceTh"><p>Formål</p></th><th colspan="1" class="confluenceTh">ID</th><th colspan="1" class="confluenceTh"><p>Local topic</p></th></tr></thead><tbody><tr><td colspan="1" class="confluenceTd">DC1</td><td colspan="1" class="confluenceTd">Door Control 1</td><td colspan="1" class="confluenceTd">FE4E</td><td colspan="1" class="confluenceTd">3411 Status 2 of doors<br>1820 Ramp/Wheel chairlift<br>1821 Position of doors&nbsp;</td><td colspan="1" class="confluenceTd"><p>Doors open / closed</p><p>&nbsp;</p></td><td colspan="1" class="confluenceTd">0000<span>FE4E</span></td><td colspan="1" class="confluenceTd">telemetry/0000fe4e/json</td></tr><tr><td colspan="1" class="confluenceTd">DC2</td><td colspan="1" class="confluenceTd">Door Control 2</td><td colspan="1" class="confluenceTd">FDA5</td><td colspan="1" class="confluenceTd">XXXX Lock Status Door N<br>XXXX&nbsp;Enable Status Door N<br>XXXX Open Status Door N</td><td colspan="1" class="confluenceTd">Alternative to DC1?</td><td colspan="1" class="confluenceTd">0000<span>FDA5</span></td><td colspan="1" class="confluenceTd"><span>telemetry</span>/0000fda5/json</td></tr><tr><td colspan="1" class="confluenceTd">VDHR</td><td colspan="1" class="confluenceTd">High Resolution Vehicle Distance</td><td colspan="1" class="confluenceTd">FEC1</td><td colspan="1" class="confluenceTd">917 High resolution total vehicle distance</td><td colspan="1" class="confluenceTd">Supplements position</td><td colspan="1" class="confluenceTd">0000<span>FEC1</span></td><td colspan="1" class="confluenceTd"><span>telemetry</span>/0000fec1/json</td></tr></tbody></table><h3>ITxPT</h3><p>These PGNs must be subscribed to when the buses are started (unless the subscription is persistent) through the AddPGN call:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="c6c84a19-2fbc-4e1f-a299-04c320050495" data-macro-parameters="language=xml" data-macro-schema-version="1" style="background-image: url(/plugins/servlet/confluence/placeholder/macro-heading?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tbody><tr><td class="wysiwyg-macro-body"><pre>&lt;PGNReq&gt;FE4E&lt;/PGNReq&gt;
&lt;PGNReq&gt;FDA5&lt;/PGNReq&gt;
&lt;PGNReq&gt;FEC1&lt;/PGNReq&gt;</pre></td></tr></tbody></table><p>A service must be implemented by the operator's vendor that listens the UDP messages and converts them to MQTT messages.</p><h3>XML format (source)</h3><p>The message for all subscribed PGNs is sent to UDP as XML.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="f540b6df-0c85-4138-9c31-a9c774c0bde0" data-macro-parameters="language=xml" data-macro-schema-version="1" style="background-image: url(/plugins/servlet/confluence/placeholder/macro-heading?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tbody><tr><td class="wysiwyg-macro-body"><pre>&lt;FMStoIPDelivery&gt;
    &lt;FMStoIP FMSVersion="03"&gt;
        &lt;frame Status="OK"&gt;
            &lt;PGN&gt;FEF1&lt;/PGN&gt;
            &lt;data&gt;F35237C403501FFF&lt;/data&gt;
            &lt;relativetime&gt;5000&lt;/relativetime&gt;
            &lt;SPN id="84"&gt;
                &lt;name&gt;Wheel-Based Vehicle Speed&lt;/name&gt;
                &lt;unit&gt;km/h&lt;/unit&gt;
                &lt;value&gt;55.3&lt;/value&gt;
            &lt;/SPN&gt;
            &lt;SPN id="597"&gt;
                &lt;name&gt;Brake Switch&lt;/name&gt;
                &lt;value&gt;released&lt;/value&gt;
            &lt;/SPN&gt;
        &lt;/frame&gt;
        &lt;frame Status="OK"&gt;
            &lt;PGN&gt;F004&lt;/PGN&gt;
            &lt;data&gt;F35237C403501FFF&lt;/data&gt;
            &lt;relativetime&gt;5000&lt;/relativetime&gt;
            &lt;SPN id="190"&gt;
                &lt;name&gt;Engine Speed&lt;/name&gt;
                &lt;unit&gt;rpm&lt;/unit&gt;
                &lt;value&gt;854&lt;/value&gt;
            &lt;/SPN&gt;
        &lt;/frame&gt;
    &lt;/FMStoIP&gt;
&lt;/FMStoIPDelivery&gt;</pre></td></tr></tbody></table><p>PGN FEF1 og F004 shown here are the examples found in the ITxPT spec.</p><h3>JSON format (MQTT)</h3><p>The message containing several PGNs is split up into several MQTT messages. SPNs are mapped as subids.</p><h4>telemetry/0000fef1/json</h4><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="31fe07ee-a0fa-4b55-8395-76a792df9ff5" data-macro-parameters="language=js" data-macro-schema-version="1" style="background-image: url(/plugins/servlet/confluence/placeholder/macro-heading?definition=e2NvZGU6bGFuZ3VhZ2U9anN9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tbody><tr><td class="wysiwyg-macro-body"><pre>{
    "eventTimestamp": "2017-10-31T12:45:50Z",
    "id": "0000FEF1",
    "payloads": [
        {
            "subid": 84,
            "name": "Wheel-Based Vehicle Speed",
            "unit": "km/h",
            "value": 55.3
        },
        {
            "subid": 597,
            "name": "Wheel-Based Vehicle Speed",
            "value": "released"
        }
    ] 
}</pre></td></tr></tbody></table><h4>telemetry/0000f004/json</h4><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="d30ab879-0d09-48fa-b4f6-7fd67f02a130" data-macro-parameters="language=js" data-macro-schema-version="1" style="background-image: url(/plugins/servlet/confluence/placeholder/macro-heading?definition=e2NvZGU6bGFuZ3VhZ2U9anN9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tbody><tr><td class="wysiwyg-macro-body"><pre>{
    "eventTimestamp": "2017-10-31T12:45:50Z",
    "id": "0000F004",
    "payloads": [
        {
            "subid": 190,
            "name": "Engine Speed",
            "unit": "rpm",
            "value": 854
        }
    ] 
}</pre></td></tr></tbody></table><h3>Fields</h3><h4>Telemetry</h4><table class="confluenceTable"><colgroup><col><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">eventTimestamp</td><td class="confluenceTd">string</td><td class="confluenceTd">ISO 8601,&nbsp;UTC</td></tr><tr><td colspan="1" class="confluenceTd">id</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">eight-digit hex value of the telemetry provided</td></tr><tr><td colspan="1" class="confluenceTd">payloads</td><td colspan="1" class="confluenceTd">array of Payload</td><td colspan="1" class="confluenceTd">one or more payloads</td></tr></tbody></table><h4>Payload</h4><table class="confluenceTable"><colgroup><col><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td colspan="1" class="confluenceTd">subid</td><td colspan="1" class="confluenceTd">int</td><td colspan="1" class="confluenceTd">subid such as SPN, if appropriate (optional)</td></tr><tr><td colspan="1" class="confluenceTd">name</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">optional</td></tr><tr><td colspan="1" class="confluenceTd">unit</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd">value</td><td colspan="1" class="confluenceTd">any</td><td colspan="1" class="confluenceTd"><br></td></tr></tbody></table><h2>tsp/json</h2><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Signal prioritization&nbsp;&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Description</th><td colspan="1" class="confluenceTd"><p><span style="color: rgb(0,0,0);">The message to be sent to VHF to ensure that the bus is prioritized at the traffic lights</span></p></td></tr><tr><th colspan="1" class="confluenceTh">Local topic</th><td colspan="1" class="confluenceTd">tsp/json</td></tr><tr><th colspan="1" class="confluenceTh">Bridged topic</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">&lt;recipient&gt;/ruter/&lt;vehicleid&gt;/itxpt/ota/tsp/json&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Schema</th><td colspan="1" class="confluenceTd">tsp.json</td></tr></tbody></table><p>This
 message is generated by Ruter when approaching an intersection or, when
 a stop is just before an intersection, after the doors have closed.</p><h3>JSON example</h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="9a6d37b0-3a0e-4497-827f-a38f18c42b36" data-macro-parameters="language=js" data-macro-schema-version="1" style="background-image: url(/plugins/servlet/confluence/placeholder/macro-heading?definition=e2NvZGU6bGFuZ3VhZ2U9anN9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tbody><tr><td class="wysiwyg-macro-body"><pre>{
    "eventTimestamp": "2017-10-31T08:38:02.749Z",
    "encodedMessage": ""
}</pre></td></tr></tbody></table><h3>Fields</h3><table class="relative-table confluenceTable"><colgroup><col style="width: 132.0px;"><col style="width: 55.0px;"><col style="width: 341.0px;"></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">eventTimestamp</td><td class="confluenceTd">string</td><td class="confluenceTd">ISO 8601, UTC</td></tr><tr><td colspan="1" class="confluenceTd">encodedMessage</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">String of characters that represent the message to transmit</td></tr></tbody></table><h2>madt/notification/json</h2><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Message to driver</span></td></tr><tr><th colspan="1" class="confluenceTh">Description</th><td colspan="1" class="confluenceTd"><p><span style="color: rgb(0,0,0);">Messages directly to the bus driver</span></p></td></tr><tr><th colspan="1" class="confluenceTh">Local topic</th><td colspan="1" class="confluenceTd">madt/notification/json</td></tr><tr><th colspan="1" class="confluenceTh">Bridged topic</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">&lt;recipient&gt;/ruter/&lt;vehicleid&gt;/itxpt/ota/madt/notification/json&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Schema</th><td colspan="1" class="confluenceTd">notification.json</td></tr></tbody></table><h3>JSON example</h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="bb298206-08c6-4771-bdf4-08c992e0eccf" data-macro-parameters="language=js" data-macro-schema-version="1" style="background-image: url(/plugins/servlet/confluence/placeholder/macro-heading?definition=e2NvZGU6bGFuZ3VhZ2U9anN9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tbody><tr><td class="wysiwyg-macro-body"><pre>{
    "eventTimestamp": "2017-10-31T08:38:02.749Z",
    "urgency": "MEDIUM",
    "subject": "Lorem ipsum",
    "content": "Duis aute irure dolor"
}</pre></td></tr></tbody></table><h3><span style="color: rgb(0,0,0);font-size: 16.0px;font-weight: bold;">Fields</span></h3><table class="confluenceTable"><colgroup><col><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">eventTimestamp</td><td class="confluenceTd">string</td><td class="confluenceTd">ISO 8601, UTC</td></tr><tr><td colspan="1" class="confluenceTd">urgency</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">enum Urgency</td></tr><tr><td colspan="1" class="confluenceTd">subject</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd">content</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd"><br></td></tr></tbody></table><h4>Enum Urgency</h4><table class="confluenceTable"><colgroup><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">LOW</td><td class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd">MEDIUM</td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd">HIGH</td><td colspan="1" class="confluenceTd"><br></td></tr></tbody></table><h2><span style="color: rgb(0,0,0);">infohub/dpi/journey/json</span></h2><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Vehicle journey&nbsp;&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Description</th><td colspan="1" class="confluenceTd"><p><span style="color: rgb(0,0,0);">The stops included in the bus route, with connections to other lines</span></p></td></tr><tr><th colspan="1" class="confluenceTh">Local topic</th><td colspan="1" class="confluenceTd">infohub/dpi/journey/json</td></tr><tr><th colspan="1" class="confluenceTh">Bridged topic</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">&lt;recipient&gt;/ruter/&lt;vehicleid&gt;/itxpt/ota/dpi/journey/json&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Schema</th><td colspan="1" class="confluenceTd">journey.json</td></tr></tbody></table><p>The
 coordinates of the stop have been added to facilitate backup 
calculations for stop announcements and possibly other messages.</p><h3>JSON example</h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="f4632c1a-902d-4dfd-87c9-a3022fcd03cf" data-macro-parameters="language=js" data-macro-schema-version="1" style="background-image: url(/plugins/servlet/confluence/placeholder/macro-heading?definition=e2NvZGU6bGFuZ3VhZ2U9anN9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tbody><tr><td class="wysiwyg-macro-body"><pre>{
  "eventTimestamp": "2017-10-31T08:38:02.749Z",
  "route": {
    "id": "RUT:Route:31-1041",
    "name": "Fornebu vest-Tonsenhagen",
    "line": {
      "id": "RUT:Line:31",
      "name": "Snarøya - Fornebu - Tonsenhagen - Grorud",
      "publicCode": "31"
    },
    "stopPlaces": [
      {
        "id": "RUT:StopPlace:02190017",
        "name": "Fornebu vest",
        "connections": [],
        "location": {
            "latitude": 12.33345,
            "longitude": 12.33345
        }
      },
      {
        "id": "RUT:StopPlace:03010013",
        "name": "Jernbanetorget",
        "connections": [
          {
            "line": {
              "id": "RUT:Line:30",
              "name": "Bygdøy via Bygdøynes",
              "publicCode": "30"
           },
           "type": "BUS",
           "color": "e60000"
         },
         {
           "line": {
             "id": "RUT:Line:12",
             "name": "Majorstuen",
             "publicCode": "12"
           },
           "type": "TRAM",
           "color": "0b91ef"
          }
        ],
        "location": {
            "latitude": 12.33345,
            "longitude": 12.33345
        }
      }
    ]
  }
}</pre></td></tr></tbody></table><h3>Fields</h3><h4>Journey</h4><table class="confluenceTable"><colgroup><col><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">eventTimestamp</td><td class="confluenceTd">string</td><td class="confluenceTd">ISO 8601, UTC</td></tr><tr><td colspan="1" class="confluenceTd">route</td><td colspan="1" class="confluenceTd">Route</td><td colspan="1" class="confluenceTd"><br></td></tr></tbody></table><h4>Route</h4><table class="confluenceTable"><colgroup><col><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">id</td><td class="confluenceTd">string</td><td class="confluenceTd">NSR code</td></tr><tr><td colspan="1" class="confluenceTd">name</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd">line</td><td colspan="1" class="confluenceTd">Line</td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd">stopPlaces</td><td colspan="1" class="confluenceTd">array of StopPlace</td><td colspan="1" class="confluenceTd"><br></td></tr></tbody></table><h4>Line</h4><table class="confluenceTable"><colgroup><col><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">id</td><td class="confluenceTd">string</td><td class="confluenceTd">NSR code</td></tr><tr><td colspan="1" class="confluenceTd">name</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd">publicCode</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd"><br></td></tr></tbody></table><h4>StopPlace</h4><table class="confluenceTable"><colgroup><col><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">id</td><td class="confluenceTd">string</td><td class="confluenceTd">NSR code</td></tr><tr><td colspan="1" class="confluenceTd">name</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd">connections</td><td colspan="1" class="confluenceTd">array of Connection</td><td colspan="1" class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd">location</td><td colspan="1" class="confluenceTd">Location</td><td colspan="1" class="confluenceTd"><br></td></tr></tbody></table><h4>Connection</h4><table class="confluenceTable"><colgroup><col><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">line</td><td class="confluenceTd">Line</td><td class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd">type</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">enum TransportType</td></tr><tr><td colspan="1" class="confluenceTd">colour</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">RGB code in hex; originally spelled color, but British spelling is preferred in European standards</td></tr></tbody></table><h4 class="auto-cursor-target">Location</h4><table class="confluenceTable"><colgroup><col><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">longitude</td><td class="confluenceTd">float</td><td class="confluenceTd"><br></td></tr><tr><td colspan="1" class="confluenceTd">latitude</td><td colspan="1" class="confluenceTd">float</td><td colspan="1" class="confluenceTd"><br></td></tr></tbody></table><h4>Enum TransportType</h4><table class="confluenceTable"><colgroup><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">BUS</td><td class="confluenceTd">This was originally listed as BUSS</td></tr><tr><td class="confluenceTd">TRAM</td><td class="confluenceTd"><br></td></tr><tr><td class="confluenceTd">OTHER</td><td class="confluenceTd"><br></td></tr></tbody></table><h2>infohub/dpi/nextstop/json</h2><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Next stop&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Description</th><td colspan="1" class="confluenceTd"><p><span style="color: rgb(0,0,0);">Next stop on the bus's route after leaving a stop</span></p></td></tr><tr><th colspan="1" class="confluenceTh">Local topic</th><td colspan="1" class="confluenceTd">infohub/dpi/nextstop/json</td></tr><tr><th colspan="1" class="confluenceTh">Bridged topic</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">&lt;recipient&gt;/ruter/&lt;vehicleid&gt;/itxpt/ota/dpi/nextstop/json&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Schema</th><td colspan="1" class="confluenceTd">nextstop.json</td></tr></tbody></table><p>StopPointRef was replaced by StopPlaceId in v. 1.1.</p><h3>JSON example</h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="be2da985-ad29-434d-b81c-53f97fe29dc1" data-macro-parameters="language=js" data-macro-schema-version="1" style="background-image: url(/plugins/servlet/confluence/placeholder/macro-heading?definition=e2NvZGU6bGFuZ3VhZ2U9anN9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tbody><tr><td class="wysiwyg-macro-body"><pre>{
    "eventTimestamp": "2017-10-31T08:38:02.749Z",
    "stopPlaceId": "RUT:StopPlace:03012453"
}</pre></td></tr></tbody></table><h3><span style="color: rgb(0,0,0);font-size: 16.0px;font-weight: bold;">Fields</span></h3><table class="confluenceTable"><colgroup><col><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">eventTimestamp</td><td class="confluenceTd">string</td><td class="confluenceTd">ISO 8601, UTC</td></tr><tr><td colspan="1" class="confluenceTd">stopPlaceId</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">NSR StopPlace code</td></tr></tbody></table><h2>infohub/dpi/eta/json</h2><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">ETA</span></td></tr><tr><th colspan="1" class="confluenceTh">Description</th><td colspan="1" class="confluenceTd"><p><span style="color: rgb(0,0,0);">Estimated arrival at the remaining stops</span></p></td></tr><tr><th colspan="1" class="confluenceTh">Local topic</th><td colspan="1" class="confluenceTd">infohub/dpi/eta/json</td></tr><tr><th colspan="1" class="confluenceTh">Bridged topic</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">&lt;recipient&gt;/ruter/&lt;vehicleid&gt;/itxpt/ota/dpi/eta/json&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Schema</th><td colspan="1" class="confluenceTd">eta.json</td></tr></tbody></table><p>StopPointRef
 was replaced by StopPlaceId in v. 1.1. The field "text" was added to 
send the desired display text for the arrival time.</p><h3>JSON example</h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="9cc4a041-92da-4e92-b04b-a74ada8e4d95" data-macro-parameters="language=js" data-macro-schema-version="1" style="background-image: url(/plugins/servlet/confluence/placeholder/macro-heading?definition=e2NvZGU6bGFuZ3VhZ2U9anN9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tbody><tr><td class="wysiwyg-macro-body"><pre>{
	"eventTimestamp": "2017-10-31T08:38:02.749Z",
	"estimatedCalls": [
		{
			"eta": "2017-10-13T12:27:04Z",
			"stopPlaceId": "RUT:StopPlace:03010510",
			"text": "Nå"
    	},
		{
			"eta": "2017-10-13T12:27:04Z",
			"stopPlaceId": "RUT:StopPlace:03010511",
			"text": "5 min"
    	}
  	]
}</pre></td></tr></tbody></table><h3><span style="color: rgb(0,0,0);font-size: 16.0px;font-weight: bold;">Fields</span></h3><table class="confluenceTable"><colgroup><col><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">eventTimestamp</td><td class="confluenceTd">string</td><td class="confluenceTd">ISO 8601, UTC</td></tr><tr><td colspan="1" class="confluenceTd">estimatedCalls</td><td colspan="1" class="confluenceTd">array of EstimatedCall</td><td colspan="1" class="confluenceTd"><br></td></tr></tbody></table><h4><span style="color: rgb(0,0,0);">EstimatedCall</span></h4><table class="confluenceTable"><colgroup><col><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">eta</td><td class="confluenceTd">string</td><td class="confluenceTd">ISO 8601, UTC</td></tr><tr><td colspan="1" class="confluenceTd">stopPlaceId</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">NSR StopPlace code</td></tr><tr><td colspan="1" class="confluenceTd">text</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">display text for passengers</td></tr></tbody></table><h2 class="auto-cursor-target">infohub/dpi/externaldisplay/json</h2><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Information for sign boxes&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Description</th><td colspan="1" class="confluenceTd"><p><span style="color: rgb(0,0,0);">Message to display on signposts. Usually line number (publicCode) and routeName, with support for alternative message</span></p></td></tr><tr><th colspan="1" class="confluenceTh">Local topic</th><td colspan="1" class="confluenceTd">infohub/dpi/externaldisplay/json</td></tr><tr><th colspan="1" class="confluenceTh">Bridged topic</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">&lt;recipient&gt;/ruter/&lt;vehicleid&gt;/itxpt/ota/dpi/externaldisplay/json&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Schema</th><td colspan="1" class="confluenceTd">externaldisplay.json</td></tr></tbody></table><h3><span style="color: rgb(0,0,0);font-size: 16.0px;font-weight: bold;">JSON example</span></h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="59c59ae4-ba9e-4d0f-9a48-061fb27a6c38" data-macro-parameters="language=js" data-macro-schema-version="1" style="background-image: url(/plugins/servlet/confluence/placeholder/macro-heading?definition=e2NvZGU6bGFuZ3VhZ2U9anN9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tbody><tr><td class="wysiwyg-macro-body"><pre>{
  "eventTimestamp": "2017-10-31T08:38:02.749Z",
  "publicCode": "31",
  "destination": "Lorem ipsum",
  "alternativeMessage": "Duis aute irure dolor"
}</pre></td></tr></tbody></table><h3><span style="color: rgb(0,0,0);font-size: 16.0px;font-weight: bold;">Fields</span></h3><table class="confluenceTable"><colgroup><col><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">eventTimestamp</td><td class="confluenceTd">string</td><td class="confluenceTd">ISO 8601, UTC</td></tr><tr><td colspan="1" class="confluenceTd">publicCode</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">Publicly known bus, tram or subway line number</td></tr><tr><td colspan="1" class="confluenceTd">destination</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">Usually the final stop</td></tr><tr><td colspan="1" class="confluenceTd">alternativeMessage</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">The use of this field must be clarified</td></tr></tbody></table><h2>infohub/dpi/arriving/json</h2><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Arrival&nbsp;&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Description</th><td colspan="1" class="confluenceTd"><p><span style="color: rgb(0,0,0);">Notice to passengers that the bus is approaching a stop</span></p></td></tr><tr><th colspan="1" class="confluenceTh">Local topic</th><td colspan="1" class="confluenceTd">infohub/dpi/arriving/json</td></tr><tr><th colspan="1" class="confluenceTh">Bridged topic</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">&lt;recipient&gt;/ruter/&lt;vehicleid&gt;/itxpt/ota/dpi/arriving/json&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Schema</th><td colspan="1" class="confluenceTd">arriving.json</td></tr></tbody></table><p>StopPointRef
 was replaced by StopPlaceId in v. 1.1.&nbsp;The field createTimestamp 
was removed in v. 1.1. Multi-lingual suoport added in v.1.2</p><p><span>The field expiryTimestamp has been added to to prevent delayed messages from being played after a certain amount of time.</span></p><h3>JSON example</h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="e1ae4dbd-a4ca-4613-b7e4-5b5dab1b12e7" data-macro-parameters="language=js" data-macro-schema-version="1" style="background-image: url(/plugins/servlet/confluence/placeholder/macro-heading?definition=e2NvZGU6bGFuZ3VhZ2U9anN9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tbody><tr><td class="wysiwyg-macro-body"><pre>{
  "eventTimestamp": "2017-10-31T08:38:02.749Z",
  "expiryTimestamp": "2017-10-31T08:38:47.749Z",
  "ref": "RUT:StopPlace:03012453",
  "zoneId": "2b-vest",
  "message": {
    "no": {
      "title": "Ankommer"
      "text": "Oslo sentralstasjon"
    },
    "en": {
      "title": "Arriving at"
      "text": "Oslo Central Station"
    }
  }
}</pre></td></tr></tbody></table><h3><span style="color: rgb(0,0,0);font-size: 16.0px;font-weight: bold;">Fields</span></h3><table class="confluenceTable"><colgroup><col><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">eventTimestamp</td><td class="confluenceTd">string</td><td class="confluenceTd">ISO 8601, UTC</td></tr><tr><td colspan="1" class="confluenceTd">expiryTimestamp</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">ISO 8601, UTC, audio should not be played after this time</td></tr><tr><td colspan="1" class="confluenceTd">ref</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">reference to StopPlaceId</td></tr><tr><td colspan="1" class="confluenceTd">zoneID</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">Id of payment zone.</td></tr><tr><td colspan="1" class="confluenceTd">message</td><td colspan="1" class="confluenceTd">dictionary of MultilingualMessage</td><td colspan="1" class="confluenceTd"><br></td></tr></tbody></table><h4><span>MultilingualMessage</span></h4><table class="confluenceTable"><colgroup><col><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><th class="confluenceTh">Type</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd">title</td><td class="confluenceTd">string</td><td class="confluenceTd">title to be display to passengers (optional)</td></tr><tr><td colspan="1" class="confluenceTd">text</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">text to be display to passengers</td></tr></tbody></table><h2>infohub/dpi/deviation/json</h2><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Deviation</span></td></tr><tr><th colspan="1" class="confluenceTh">Description</th><td colspan="1" class="confluenceTd"><p><span style="color: rgb(0,0,0);">Notice to passengers of a deviation</span></p></td></tr><tr><th colspan="1" class="confluenceTh">Local topic</th><td colspan="1" class="confluenceTd">infohub/dpi/deviation/json</td></tr><tr><th colspan="1" class="confluenceTh">Bridged topic</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">&lt;recipient&gt;/ruter/&lt;vehicleid&gt;/itxpt/ota/dpi/deviation/json&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Schema</th><td colspan="1" class="confluenceTd">deviation.json</td></tr></tbody></table><p>The
 ref field has been added to specify the scope of the deviation. This 
should be an NSR ID (where the type is included in the ID) such as 
StopPlaceId, QuayId, LineId, RouteId, JourneyId, OperatorId or 
AuthorityId. It is possible additional identifiers may be included.</p><h3>JSON example</h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="1444427d-f82d-4432-9845-08f0e5dcf276" data-macro-parameters="language=js" data-macro-schema-version="1" style="background-image: url(/plugins/servlet/confluence/placeholder/macro-heading?definition=e2NvZGU6bGFuZ3VhZ2U9anN9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tbody><tr><td class="wysiwyg-macro-body"><pre>{
    "eventTimestamp": "2017-10-31T08:38:02.749Z",
    "expiryTimestamp": "2017-10-31T08:38:47.749Z",
    "ref": [
        "NSR:StopPlace:2561",
		"NSR:StopPlace:2562"
    ],
    "message": {
        "no": {
            "title": "afsdf",
            "text": "Lorem ipsum dolor sit amet"
        },
        "en": {
            "title": "afsdf",
            "text": "Lorem ipsum dolor sit amet"
        }
    }
}</pre></td></tr></tbody></table><h3><span style="color: rgb(0,0,0);font-size: 16.0px;font-weight: bold;">Fields</span></h3><table class="confluenceTable"><colgroup><col><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">eventTimestamp</td><td class="confluenceTd">string</td><td class="confluenceTd">ISO 8601, UTC</td></tr><tr><td colspan="1" class="confluenceTd">expiryTimestamp</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd"><span>ISO 8601, UTC, do not show after</span></td></tr><tr><td colspan="1" class="confluenceTd">ref</td><td colspan="1" class="confluenceTd">string or array of strings</td><td colspan="1" class="confluenceTd">List of affected entities, if empty or not included the deviation is general</td></tr><tr><td colspan="1" class="confluenceTd">message</td><td colspan="1" class="confluenceTd">dictionary of MultilingualMessage</td><td colspan="1" class="confluenceTd"><br></td></tr></tbody></table><p>Responsibility
 for the use of the ref field lies entirely with the DPI application. 
When it has matching ids it can tailor the information display 
accordingly. An example of this is stopPlaceId deviations.</p><h4>MultilingualMessage</h4><table class="confluenceTable"><colgroup><col><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><th class="confluenceTh">Type</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd">title</td><td class="confluenceTd">string</td><td class="confluenceTd">title to be displayed to the passengers (optional)</td></tr><tr><td colspan="1" class="confluenceTd">text</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">text to be displayed to the passengers</td></tr></tbody></table><p><br></p><h2>infohub/dpi/announcement/json</h2><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Announcement&nbsp;&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Description</th><td colspan="1" class="confluenceTd"><p><span style="color: rgb(0,0,0);"><span style="color: rgb(0,0,0);">Announcement</span> to the passengers (ad hoc)</span></p></td></tr><tr><th colspan="1" class="confluenceTh">Local topic</th><td colspan="1" class="confluenceTd">infohub/dpi/announcement/json</td></tr><tr><th colspan="1" class="confluenceTh">Bridged topic</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">&lt;recipient&gt;/ruter/&lt;vehicleid&gt;/itxpt/ota/dpi/announcement/json&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Schema</th><td colspan="1" class="confluenceTd">announcement.json</td></tr></tbody></table><p>Message contains a reference to the scope of the message, if applicable. Typically NSR stopplaceid / lineId or similar.&nbsp;</p><h3>JSON example</h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="0783b0fd-0d4e-4831-ace9-0353b8795973" data-macro-parameters="language=js" data-macro-schema-version="1" style="background-image: url(/plugins/servlet/confluence/placeholder/macro-heading?definition=e2NvZGU6bGFuZ3VhZ2U9anN9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tbody><tr><td class="wysiwyg-macro-body"><pre>{
    "eventTimestamp": "2017-10-31T08:38:02.749Z",
    "expiryTimestamp": "2017-10-31T08:38:47.749Z",
	"type": "INFO",
    "ref": [
        "NSR:StopPlace:2561",
		"NSR:StopPlace:2562"
    ],
    "message": {
        "no": {
            "title": "afsdf",
            "text": "Lorem ipsum dolor sit amet"
        },
        "en": {
            "title": "afsdf",
            "text": "Lorem ipsum dolor sit amet"
        }
    }
}</pre></td></tr></tbody></table><h3><span style="color: rgb(0,0,0);font-size: 16.0px;font-weight: bold;">Fields</span></h3><table class="confluenceTable"><colgroup><col><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">eventTimestamp</td><td class="confluenceTd">string</td><td class="confluenceTd">ISO 8601, UTC</td></tr><tr><td colspan="1" class="confluenceTd">expiryTimestamp</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">ISO 8601, UTC</td></tr><tr><td colspan="1" class="confluenceTd">type</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">Type melding: kan styre visning i DPI</td></tr><tr><td colspan="1" class="confluenceTd">ref</td><td colspan="1" class="confluenceTd">String or array of strings</td><td colspan="1" class="confluenceTd">Liste av id'er som f.eks. StopPlace, Line, Route, VehicleJourney.<br>brukes til å knytte avvik til bestemte scopes, ikke påkrevd&nbsp;</td></tr><tr><td colspan="1" class="confluenceTd"><span>message</span></td><td colspan="1" class="confluenceTd">dictionary of MultilingualMessage</td><td colspan="1" class="confluenceTd">Key is ISO 639-1 language code.</td></tr></tbody></table><h4>MultilingualMessage</h4><table class="confluenceTable"><colgroup><col><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><th class="confluenceTh">Type</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd">title</td><td class="confluenceTd">string</td><td class="confluenceTd">title to be displayed to the passengers (optional)</td></tr><tr><td colspan="1" class="confluenceTd">text</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">text to be displayed to the passengers</td></tr></tbody></table><h2><span>infohub/dpi/audio/json</span></h2><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Navn</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Audio message&nbsp;&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Beskrivelse</th><td colspan="1" class="confluenceTd"><p><span style="color: rgb(0,0,0);">Audio message to be played by the speaker system on the bus.</span></p></td></tr><tr><th colspan="1" class="confluenceTh">Lokal topic</th><td colspan="1" class="confluenceTd">infohub/dpi/audio/json</td></tr><tr><th colspan="1" class="confluenceTh">Bridged topic</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">&lt;recipient&gt;/ruter/&lt;vehicleId&gt;/itxpt/ota/dpi/audio/json&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Schema</th><td colspan="1" class="confluenceTd">audio.json</td></tr></tbody></table><p>Topic
 used exclusively to transmit audio messages to be played by the speaker
 system. The audio messages may contain an array of sound bites, that 
are to be played in the sequence they have been received.&nbsp;&nbsp;</p><h3>JSON example</h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="ffebc79c-daba-4ca3-ae57-8823706a0d01" data-macro-parameters="language=js" data-macro-schema-version="1" style="background-image: url(/plugins/servlet/confluence/placeholder/macro-heading?definition=e2NvZGU6bGFuZ3VhZ2U9anN9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tbody><tr><td class="wysiwyg-macro-body"><pre>{
  "eventTimestamp": "2017-10-31T08:38:02.749Z",
  "expiryTimestamp": "2017-10-31T08:38:47.749Z",
  "type": "ARRIVING",
  "ref": "RUT:StopPlace:03012453",
  "value": [
    {
      "encoding": "OPUS",
      "content": "ZkxhQwAAACIQABAAAAUJABtAA+gA8AB+W8FZndQvQAyjv...",
      "speaker": "PASSENGERS",
      "volume": 70
    },
    {
      "encoding": "MP3",
      "content": "ZkxhQwAAACIQABAAAAUJABtAA+gA8AB+W8FZndQvQAyjv...",
      "speaker": "DRIVER",
      "volume": 60
    },
    {
      "encoding": "MP3",
      "content": "ZkxhQwAAACIQABAAAAUJABtAA+gA8AB+W8FZndQvQAyjv...",
      "speaker": "EXTERNAL",
      "volume": 80
    }
  ]
}
</pre></td></tr></tbody></table><h4><span style="color: rgb(0,0,0);">Fields</span></h4><table class="confluenceTable"><colgroup><col><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Navn</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Beskrivelse</p></th></tr></thead><tbody><tr><td class="confluenceTd">eventTimestamp</td><td class="confluenceTd">string</td><td class="confluenceTd">ISO 8601, UTC</td></tr><tr><td colspan="1" class="confluenceTd">expiryTimestamp</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">ISO 8601, UTC</td></tr><tr><td colspan="1" class="confluenceTd">type</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">Type of audio message</td></tr><tr><td colspan="1" class="confluenceTd">ref</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">reference to what the audio is about</td></tr><tr><td colspan="1" class="confluenceTd">value</td><td colspan="1" class="confluenceTd">array of Audio</td><td colspan="1" class="confluenceTd">one or more sound bits to be played in sequence</td></tr></tbody></table><h4>Audio</h4><table class="confluenceTable"><colgroup><col><col><col></colgroup><tbody><tr><th class="confluenceTh">Navn</th><th class="confluenceTh">Type</th><th class="confluenceTh">Beskrivelse</th></tr><tr><td class="confluenceTd">encoding</td><td class="confluenceTd">string</td><td class="confluenceTd">enum Encoding</td></tr><tr><td colspan="1" class="confluenceTd">content</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">Base 64 encoded audio data</td></tr><tr><td colspan="1" class="confluenceTd">speaker</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">enum of SpeakerType</td></tr><tr><td colspan="1" class="confluenceTd">volume</td><td colspan="1" class="confluenceTd">int</td><td colspan="1" class="confluenceTd">1-100</td></tr></tbody></table><h4>Enum Encoding</h4><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Navn</th><th class="confluenceTh">Beskrivelse</th></tr><tr><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">OPUS</span></td><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Opus Audio Codec (<a href="https://tools.ietf.org/html/rfc6716">rfc6716</a>)</span></td></tr><tr><td class="confluenceTd">MP3</td><td class="confluenceTd">MP3 Codec</td></tr></tbody></table><h4>Enum SpeakerType</h4><table class="relative-table confluenceTable" style="width: 604.0px;"><colgroup><col style="width: 0.0px;"><col style="width: 0.0px;"><col style="width: 0.0px;"></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th colspan="1" class="confluenceTh">Prio</th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">PASSENGERS</td><td colspan="1" class="confluenceTd">1</td><td class="confluenceTd">Internal speaker for passengers</td></tr><tr><td class="confluenceTd">DRIVER</td><td colspan="1" class="confluenceTd">2</td><td class="confluenceTd">internal speaker for the driver only</td></tr><tr><td class="confluenceTd">EXTERNAL</td><td colspan="1" class="confluenceTd">3</td><td class="confluenceTd">External speaker for announcements to waiting passengers</td></tr></tbody></table><p>Speaker types corresponds to the&nbsp;ITxPT-standard, S01v2.0.1_2017, Vehicle Installation Requirements Specification, side 32.</p><h2>infohub/dpi/c2/json</h2><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Command and controls channel</span></td></tr><tr><th colspan="1" class="confluenceTh">Description</th><td colspan="1" class="confluenceTd"><p><span style="color: rgb(0,0,0);">Command and control messages from Ruter Data Platform</span></p></td></tr><tr><th colspan="1" class="confluenceTh">Local topic</th><td colspan="1" class="confluenceTd">infohub/dpi/c2/json</td></tr><tr><th colspan="1" class="confluenceTh">Bridged topic</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">ruter/&lt;sender&gt;/&lt;vehicleid&gt;/itxpt/ota/dpi/c2/json&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Schema</th><td colspan="1" class="confluenceTd">c2.json</td></tr></tbody></table><p>The c2 channels is reserved for command and control messages originated by Ruter. Typical use cases include:&nbsp;</p><ul><li>Diagnostics / debugging<ul><li>Trigger transfer of debug information</li><li>Trigger screenshot of DPI screen</li><li>Trigger clearing of cache and refresh of webpage</li></ul></li><li>Content<ul><li>Trigger display of campaign</li></ul></li></ul><p>The payload is defined as an object with no structure to provide flexibility.&nbsp;</p><h3>JSON example - DEBUG</h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="6d06cf96-1bc6-43b9-817b-83f00cbf790e" data-macro-parameters="language=js" data-macro-schema-version="1" style="background-image: url(/plugins/servlet/confluence/placeholder/macro-heading?definition=e2NvZGU6bGFuZ3VhZ2U9anN9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tbody><tr><td class="wysiwyg-macro-body"><pre>{
    "eventTimestamp": "2018-10-31T12:45:50Z",
    "type": "DEBUG",
    "payload": {
		"command": "LOG_TRANSFER",
		"arg": {
			"level": "ERROR", 
			"limit": 10, 
			"page": 0  
		}
    }
}</pre></td></tr></tbody></table><h3>JSON example - SET_ITEM</h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="a391a8a8-bc0e-4369-b62a-c2d20ab683c3" data-macro-parameters="language=js" data-macro-schema-version="1" style="background-image: url(/plugins/servlet/confluence/placeholder/macro-heading?definition=e2NvZGU6bGFuZ3VhZ2U9anN9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tbody><tr><td class="wysiwyg-macro-body"><pre>{
    "eventTimestamp": "2018-10-31T12:45:50Z",
    "type": "WORKER_JOB",
    "payload": {
		"command": "SET_ITEM",
		"arg": {
			"name": "enableFeatureX",
			"value": true
		}
    }
}</pre></td></tr></tbody></table><h3>Fields</h3><table class="confluenceTable"><colgroup><col><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">eventTimestamp</td><td class="confluenceTd">string</td><td class="confluenceTd">ISO 8601,&nbsp;UTC</td></tr><tr><td colspan="1" class="confluenceTd">type</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">message type</td></tr><tr><td colspan="1" class="confluenceTd">payload</td><td colspan="1" class="confluenceTd">Object</td><td colspan="1" class="confluenceTd"><br></td></tr></tbody></table><h2>infohub/dpi/diagnostics/json</h2><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Screen diagnostics&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Description</th><td colspan="1" class="confluenceTd"><p><span style="color: rgb(0,0,0);">Report to PTA BO about a screen</span></p></td></tr><tr><th colspan="1" class="confluenceTh">Local topic</th><td colspan="1" class="confluenceTd">infohub/dpi/diagnostics/json</td></tr><tr><th colspan="1" class="confluenceTh">Bridged topic</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">ruter/&lt;sender&gt;/&lt;vehicleid&gt;/itxpt/ota/dpi/diagnostics/json&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Schema</th><td colspan="1" class="confluenceTd">diagnostics.json</td></tr></tbody></table><p>It is expected that the DPI application itself&nbsp;will produce diagnostic messages.</p><p>The payload is defined as an object with no structure to provide flexibility.&nbsp;</p><p>The
 types illustrated below are example of possible messages. The types are
 under discussion but will be generated entirely by the DPI application 
and consumed by the PTA BO.</p><h3>JSON example - STATUS</h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="1e9a2602-b363-41a0-a8c4-a1a22e6b171a" data-macro-parameters="language=js" data-macro-schema-version="1" style="background-image: url(/plugins/servlet/confluence/placeholder/macro-heading?definition=e2NvZGU6bGFuZ3VhZ2U9anN9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tbody><tr><td class="wysiwyg-macro-body"><pre>{
    "eventTimestamp": "2018-10-31T12:45:50Z",
    "screenId": "ad71dba8-c881-11e8-a8d5-f2801f1b9fd1",	
    "type": "STATUS",
    "payload": {
        "version": {
            "application": "2018-10-03T12:45:50Z",
            "media": "2018-10-05T12:45:50Z",
        },
        "display": {
            "type": "1", 
            "res": {
                "height": 360,
                "width": 1080
            }
        },
        "stats": {
            "logEntries": {
                "error": 0,
                "warning": 14,
                "info": 123
            },
            "lastLoaded": "2018-10-31T12:45:45Z",
			"pingFreq": 3600
            "usedStorage": "124kb"        
        }
    }
}</pre></td></tr></tbody></table><h3>JSON example -&nbsp;HEARTBEAT</h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="a2d1cc1c-8649-4c95-913f-de6fc3371720" data-macro-parameters="language=js" data-macro-schema-version="1" style="background-image: url(/plugins/servlet/confluence/placeholder/macro-heading?definition=e2NvZGU6bGFuZ3VhZ2U9anN9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tbody><tr><td class="wysiwyg-macro-body"><pre>{
    "eventTimestamp": "2018-10-31T12:45:50Z",
    "type": "HEARTBEAT",
    "screenId": "ad71dba8-c881-11e8-a8d5-f2801f1b9fd1",	
}</pre></td></tr></tbody></table><h3>Fields</h3><table class="confluenceTable"><colgroup><col><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Type</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd">eventTimestamp</td><td class="confluenceTd">string</td><td class="confluenceTd">ISO 8601,&nbsp;UTC</td></tr><tr><td colspan="1" class="confluenceTd">screenId</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">UUID produced and stored by the application per screen</td></tr><tr><td colspan="1" class="confluenceTd">type</td><td colspan="1" class="confluenceTd">string</td><td colspan="1" class="confluenceTd">message type, enum DiagnosticType</td></tr><tr><td colspan="1" class="confluenceTd">payload</td><td colspan="1" class="confluenceTd">dictionary of any</td><td colspan="1" class="confluenceTd">data with a blend possibly of standardized keys and PTA / PTO-specific</td></tr></tbody></table><h3>Enum DiagnosticType</h3><table class="confluenceTable"><colgroup><col><col></colgroup><thead><tr><th class="confluenceTh"><p>Name</p></th><th class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td class="confluenceTd"><p>STATUS</p></td><td class="confluenceTd">When the screen is turned on and the application application starts, this message is sent</td></tr><tr><td colspan="1" class="confluenceTd">HEARTBEAT</td><td colspan="1" class="confluenceTd">A regular message that the screen is alive; frequency every X period</td></tr></tbody></table><p>Other types of messages may be defined later.</p><h1>Planned Topics</h1><h2>infohub/dpi/connections/json</h2><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Connections&nbsp;&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Description</th><td colspan="1" class="confluenceTd"><p><span style="color: rgb(0,0,0);">A snapshot of real-time data about the transit connections at the next stop</span></p></td></tr><tr><th colspan="1" class="confluenceTh">Local topic</th><td colspan="1" class="confluenceTd">infohub/dpi/connections/json</td></tr><tr><th colspan="1" class="confluenceTh">Bridged topic</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">&lt;recipient&gt;/ruter/&lt;vehicleid&gt;/itxpt/ota/dpi/connections/json&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Schema</th><td colspan="1" class="confluenceTd">connections.json</td></tr></tbody></table><p>This
 message is intended to be sent before the bus comes to the next stop. 
It is possible that it is sent only once, but it may also be updated if 
the view changes.</p><h2>infohub/dpi/digitalsignage/json</h2><table class="confluenceTable"><colgroup><col><col></colgroup><tbody><tr><th class="confluenceTh">Name</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">Multimedia control</span></td></tr><tr><th colspan="1" class="confluenceTh">Description</th><td colspan="1" class="confluenceTd"><p><span style="color: rgb(0,0,0);">Change what appears on the target surfaces of the screens</span></p></td></tr><tr><th colspan="1" class="confluenceTh">Local topic</th><td colspan="1" class="confluenceTd">infohub/dpi/digitalsignage/json</td></tr><tr><th colspan="1" class="confluenceTh">Bridged topic</th><td colspan="1" class="confluenceTd"><span style="color: rgb(0,0,0);">&lt;recipient&gt;/ruter/&lt;vehicleid&gt;/itxpt/ota/dpi/digitalsignage/json&nbsp;</span></td></tr><tr><th colspan="1" class="confluenceTh">Schema</th><td colspan="1" class="confluenceTd">digitalsignage.json</td></tr></tbody></table><p>When
 we begin to deliver packages of media to the buses, for example, in 
connection with campaigns, we must be able to trigger playlists as 
needed, for example at a stop, a time, etc.</p><h1>Summary of Changes</h1><table class="fixed-table confluenceTable"><colgroup><col style="width: 107.0px;"><col style="width: 225.0px;"><col style="width: 509.0px;"></colgroup><thead><tr><th colspan="1" class="confluenceTh">Category</th><th class="confluenceTh"><p>Topic</p></th><th colspan="1" class="confluenceTh">Description</th></tr></thead><tbody><tr><td class="highlight-blue confluenceTd" colspan="1" data-highlight-colour="blue"><span>added field</span></td><td colspan="1" class="confluenceTd"><span>infohub/dpi/</span>journey/json</td><td colspan="1" class="confluenceTd">added location (latitude and longitude) per stop place</td></tr><tr><td class="highlight-blue confluenceTd" colspan="1" data-highlight-colour="blue">added field</td><td colspan="1" class="confluenceTd"><span>infohub/dpi/</span>eta/json</td><td colspan="1" class="confluenceTd"><span>the field text has been added for display text in DPI</span></td></tr><tr><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">changed field</td><td colspan="1" class="confluenceTd"><span><span>infohub/dpi/</span>eta/json</span></td><td colspan="1" class="confluenceTd">the field expectedArrivalTime has been renamed eta</td></tr><tr><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">changed field</td><td colspan="1" class="confluenceTd"><span>infohub/dpi/</span><span>externaldisplay/json</span></td><td colspan="1" class="confluenceTd">the field routeName has been renamed destination</td></tr><tr><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red">removed field</td><td colspan="1" class="confluenceTd"><span>infohub/dpi/</span>arriving/json</td><td colspan="1" class="confluenceTd">audio has been removed; see new audio/json topic</td></tr><tr><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">changed field</td><td colspan="1" class="confluenceTd"><span><span>infohub/dpi/</span>arriving/json</span></td><td colspan="1" class="confluenceTd">the field message was made multilingual</td></tr><tr><td class="highlight-blue confluenceTd" colspan="1" data-highlight-colour="blue">added field</td><td colspan="1" class="confluenceTd"><span>infohub/dpi/</span>arriving/json</td><td colspan="1" class="confluenceTd">the field zoneId was added to support the sales system</td></tr><tr><td class="highlight-red confluenceTd" colspan="1" data-highlight-colour="red">removed field</td><td colspan="1" class="confluenceTd"><span>infohub/dpi/</span>deviation/json</td><td colspan="1" class="confluenceTd"><span>audio has been removed; see new audio/json topic</span></td></tr><tr><td class="highlight-yellow confluenceTd" colspan="1" data-highlight-colour="yellow">changed field</td><td colspan="1" class="confluenceTd"><span>infohub/dpi/</span>deviation/json</td><td colspan="1" class="confluenceTd"><span>the field message was made multilingual</span></td></tr><tr><td class="highlight-blue confluenceTd" colspan="1" data-highlight-colour="blue">added field</td><td colspan="1" class="confluenceTd"><span>infohub/dpi/</span>deviation/json</td><td colspan="1" class="confluenceTd">the field ref was added to indicate what the deviation affects</td></tr><tr><td class="highlight-red confluenceTd" data-highlight-colour="red">removed field</td><td class="confluenceTd"><span>infohub/dpi/</span>announcement/json</td><td class="confluenceTd"><span>audio has been removed; see new audio/json topic</span></td></tr><tr><td class="highlight-yellow confluenceTd" data-highlight-colour="yellow">changed field</td><td class="confluenceTd"><span><span>infohub/dpi/</span>announcement</span>/json</td><td class="confluenceTd"><span>the field message was made multilingual</span></td></tr><tr><td class="highlight-blue confluenceTd" data-highlight-colour="blue">added field</td><td class="confluenceTd"><span><span>infohub/dpi/</span>announcement</span>/json</td><td class="confluenceTd">the field ref was added to indicate what the deviation affects</td></tr><tr><td class="highlight-blue confluenceTd" data-highlight-colour="blue">added field</td><td class="confluenceTd"><span><span>infohub/dpi/</span>announcement</span>/json</td><td class="confluenceTd">the field type was added to support DPI needs</td></tr><tr><td class="highlight-green confluenceTd" data-highlight-colour="green">new topic</td><td class="confluenceTd">stopsignal/json</td><td class="confluenceTd">new topic for stop signal status when changed by using stop button</td></tr><tr><td class="highlight-green confluenceTd" data-highlight-colour="green">new topic</td><td class="confluenceTd">telemetry/+/json</td><td class="confluenceTd">new topic for vehicle&nbsp;<span style="color: rgb(0,0,0);">telemetry</span>&nbsp;from systems on the bus, including FMS data</td></tr><tr><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">new topic</td><td colspan="1" class="confluenceTd">tsp/json</td><td colspan="1" class="confluenceTd">new topic for traffic signal pre-emption message</td></tr><tr><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">new topic</td><td class="confluenceTd">infohub/dpi/audio/json</td><td colspan="1" class="confluenceTd">new topic on which <strong>all</strong> <strong>audio</strong> will be sent</td></tr><tr><td class="highlight-green confluenceTd" colspan="1" data-highlight-colour="green">new topic</td><td colspan="1" class="confluenceTd">infohub/dpi/c2/json</td><td colspan="1" class="confluenceTd">new topic to send commands to DPI application</td></tr><tr><td class="highlight-green confluenceTd" data-highlight-colour="green"><span>new topic </span></td><td class="confluenceTd"><span>infohub/dpi/</span>diagnostic/json</td><td class="confluenceTd">used by DPI only to send diagnostic info to BO</td></tr></tbody></table><p class="auto-cursor-target"><br></p>
        <p>&nbsp;</p>
    

</body></html>
